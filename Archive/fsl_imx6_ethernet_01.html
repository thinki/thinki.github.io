
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Freescale i.MX6 Linux Ethernet Driver驱动源码分析01 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="fsl_imx6_ethernet_02.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    About Me
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../Cloud/">
            
                <a href="../Cloud/">
            
                    
                    Cloud
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../Cloud/How_qemu_kvm_manage_mem_part1.html">
            
                <a href="../Cloud/How_qemu_kvm_manage_mem_part1.html">
            
                    
                    How Qemu/KVM manage VM memory: Part1 system ram
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../Cloud/How_qemu_kvm_manage_mem_part2.html">
            
                <a href="../Cloud/How_qemu_kvm_manage_mem_part2.html">
            
                    
                    How Qemu/KVM manage VM memory: Part2 mmio
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../Cloud/linux_macvlan_and_nic_offload.html">
            
                <a href="../Cloud/linux_macvlan_and_nic_offload.html">
            
                    
                    Linux Macvlan and NIC offload
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../Cloud/switchdev_and_port_representor.html">
            
                <a href="../Cloud/switchdev_and_port_representor.html">
            
                    
                    Linux switchdev and DPDK port representor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../Cloud/cpu_memory_order_part1.html">
            
                <a href="../Cloud/cpu_memory_order_part1.html">
            
                    
                    CPU memory order: Part1 summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../Cloud/cpu_memory_order_part2.html">
            
                <a href="../Cloud/cpu_memory_order_part2.html">
            
                    
                    CPU memory order: Part2 total store ordering 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../Cloud/cpu_memory_order_part3.html">
            
                <a href="../Cloud/cpu_memory_order_part3.html">
            
                    
                    CPU memory order: Part3 weak memory ordering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../Cloud/cpu_memory_order_part4.html">
            
                <a href="../Cloud/cpu_memory_order_part4.html">
            
                    
                    CPU memory order: Part4 memory barrier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../Cloud/Stateless_offload_uso_ufo.html">
            
                <a href="../Cloud/Stateless_offload_uso_ufo.html">
            
                    
                    Stateless offload: USO and UFO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../Cloud/dump_function_call.html">
            
                <a href="../Cloud/dump_function_call.html">
            
                    
                    Dump function call trace in linux kernel/user
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../Cloud/lock_free_programming.html">
            
                <a href="../Cloud/lock_free_programming.html">
            
                    
                    Lock Free Programming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../Cloud/meson_build_for_local_lib.html">
            
                <a href="../Cloud/meson_build_for_local_lib.html">
            
                    
                    Meson build guide for local installed library
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    网易博客存档
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="fsl_imx6_ethernet_01.html">
            
                <a href="fsl_imx6_ethernet_01.html">
            
                    
                    Freescale i.MX6 Linux Ethernet Driver驱动源码分析01
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="fsl_imx6_ethernet_02.html">
            
                <a href="fsl_imx6_ethernet_02.html">
            
                    
                    Freescale i.MX6 Linux Ethernet Driver驱动源码分析02
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="linux_books.html">
            
                <a href="linux_books.html">
            
                    
                    Linux Programming 经典书单
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Freescale i.MX6 Linux Ethernet Driver驱动源码分析01</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="freescale-imx6-linux-ethernet-driver&#x9A71;&#x52A8;&#x6E90;&#x7801;&#x5206;&#x6790;01">Freescale i.MX6 Linux Ethernet Driver&#x9A71;&#x52A8;&#x6E90;&#x7801;&#x5206;&#x6790;01</h1>
<p><strong>&#x672C;&#x6587;&#x6700;&#x521D;&#x53D1;&#x8868;&#x4E8E;2014-07-31&#xFF0C;&#x7F51;&#x6613;&#x535A;&#x5BA2;</strong></p>
<p>&#x6700;&#x8FD1;&#x9700;&#x8981;&#x5728;Freescale i.MX6&#x4E0A;&#x79FB;&#x690D;Ethernet AVB&#x7684;&#x5185;&#x6838;patch&#xFF0C;Ethernet AVB&#x7684;Wiki&#xFF1A;<a href="http://en.wikipedia.org/wiki/Audio_Video_Bridging&#xFF0C;&#x800C;Freescale&#x539F;&#x6765;&#x5DF2;&#x7ECF;&#x5728;kernel" target="_blank">http://en.wikipedia.org/wiki/Audio_Video_Bridging&#xFF0C;&#x800C;Freescale&#x539F;&#x6765;&#x5DF2;&#x7ECF;&#x5728;kernel</a> 3.0.35 LTIB 4.0.0&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x63D0;&#x4F9B;&#x4E86;patch&#xFF1A;<a href="https://community.freescale.com/docs/DOC-95578&#xFF0C;&#x73B0;&#x5728;&#x9700;&#x8981;&#x505A;&#x7684;&#x662F;&#x628A;kernel" target="_blank">https://community.freescale.com/docs/DOC-95578&#xFF0C;&#x73B0;&#x5728;&#x9700;&#x8981;&#x505A;&#x7684;&#x662F;&#x628A;kernel</a> 3.0.35&#x4E0A;&#x7684;patch&#x79FB;&#x690D;&#x5230;yocto kernel-3.10.17_ga&#x4E0A;&#xFF0C;&#x7B2C;&#x4E00;&#x6B21;&#x542C;&#x4E0A;&#x53BB;&#x5C31;&#x611F;&#x89C9;&#x50CF;&#x662F;&#x4EE3;&#x7801;&#x7684;&#x590D;&#x5236;&#x7C98;&#x8D34;&#xFF0C;&#x4E0D;&#x8FC7;&#x9996;&#x8981;&#x7684;&#x95EE;&#x9898;&#x662F;Ethernet Driver&#x90FD;&#x6CA1;&#x6709;&#x770B;&#x8FC7;&#xFF0C;&#x8FD8;&#x8C08;&#x4F55;&#x79FB;&#x690D;&#xFF0C;&#x6240;&#x4EE5;&#x7D22;&#x6027;&#x628A;Ethernet Driver&#x4E5F;&#x5B66;&#x4E60;&#x4E00;&#x904D;&#xFF0C;Google&#x4E86;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#xFF0C;&#x627E;&#x5230;&#x4E86;&#x51E0;&#x4EFD;&#x4E0D;&#x9519;&#x7684;&#x5B66;&#x4E60;&#x8D44;&#x6599;&#xFF0C;&#x7279;&#x6B64;&#x5171;&#x4EAB;&#x4E4B;&#xFF1A;<a href="http://free-electrons.com/doc/network-drivers-lab.pdf" target="_blank">http://free-electrons.com/doc/network-drivers-lab.pdf</a> </p>
<p>&#x300A;Linux network driver development Training lab book&#x300B;&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;&#x6700;&#x7ECF;&#x5178;&#x7684;&#x5B66;&#x4E60;&#x8D44;&#x6599;&#xFF0C;&#x4ECE;&#x65E0;&#x5230;&#x6709;&#x5730;&#x8BB2;&#x8FF0;&#x4E86;&#x7F51;&#x5361;&#x9A71;&#x52A8;&#x7684;&#x7F16;&#x5199;&#x8FC7;&#x7A0B;&#xFF0C;&#x57FA;&#x4E8E;Atmel&#x7684;MPU&#x7684;Ethernet Controller&#x3002;<a href="http://lwn.net/images/pdf/LDD3/ch17.pdf" target="_blank">http://lwn.net/images/pdf/LDD3/ch17.pdf</a></p>
<p>&#x300A;LDD3&#x300B;&#x7684;&#x7B2C;17&#x7AE0;&#x8282;&#x4E13;&#x95E8;&#x8BB2;&#x8FF0;&#x4E86;network driver&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x91CC;&#x9762;&#x7740;&#x91CD;&#x4ECB;&#x7ECD;&#x4E86;&#x4E00;&#x4E9B;&#x6280;&#x672F;&#x7EC6;&#x8282;&#xFF0C;&#x9002;&#x5408;&#x5F53;&#x5DE5;&#x5177;&#x4E66;&#x6765;&#x770B;&#x3002;</p>
<p><a href="http://free-electrons.com/training/kernel/" target="_blank">http://free-electrons.com/training/kernel/</a>  &#x8FD9;&#x4E2A;&#x9875;&#x9762;&#x662F;&#x5076;&#x7136;&#x627E;&#x5230;&#x7684;&#xFF0C;&#x4E0D;&#x8FC7;&#x5BF9;free-electrons&#x5370;&#x8C61;&#x4E00;&#x76F4;&#x4E0D;&#x9519;&#xFF0C;&#x6240;&#x4EE5;&#x5F3A;&#x70C8;&#x63A8;&#x8350;&#xFF0C;&#x8FD9;&#x662F;&#x4E13;&#x95E8;&#x8BB2;&#x5185;&#x6838;&#x4E0E;&#x9A71;&#x52A8;&#x5F00;&#x53D1;&#x7684;&#x6750;&#x6599;&#x3002;</p>
<p>&#x90A3;&#x51E0;&#x5929;&#x6211;&#x786C;&#x7740;&#x5934;&#x76AE;&#x628A;&#x300A;Linux network driver development Training lab book&#x300B;&#x770B;&#x5B8C;&#x4E86;&#xFF0C;&#x540E;&#x6765;&#x53C8;&#x770B;&#x4E86;&#x4E24;&#x904D;&#xFF0C;&#x5BF9;Linux Ethernet Driver&#x6709;&#x4E86;&#x6BD4;&#x8F83;&#x6574;&#x4F53;&#x7684;&#x8BA4;&#x8BC6;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x5DE5;&#x4F5C;&#x5C31;&#x662F;&#x7406;&#x89E3;i.MX6 3.0.35&#x5185;&#x6838;&#x7684;&#x9A71;&#x52A8;&#x6E90;&#x7801;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x4E0D;&#x5F97;&#x4E0D;&#x79F0;&#x8D5E;&#x7684;&#x662F;&#xFF0C;Freescale&#x7684;&#x9A71;&#x52A8;&#x6709;&#x76F8;&#x5E94;&#x7684;&#x300A;i.MX 6Dual/6Quad Linux Reference
Manual&#x300B;&#x6587;&#x6863;&#x53EF;&#x4EE5;&#x4ECE;&#x5B98;&#x7F51;&#x4E0A;&#x4E0B;&#x5230;&#xFF0C;&#x5B83;&#x4F1A;&#x7ED9;&#x4F60;&#x4E00;&#x4E9B;&#x7B80;&#x8981;&#x7684;&#x4ECB;&#x7ECD;&#x3002;&#x8FD9;&#x5BF9;&#x4E8E;&#x5F88;&#x591A;&#x521D;&#x5B66;&#x8005;&#x6765;&#x8BF4;&#x8FD8;&#x662F;&#x975E;&#x5E38;&#x53CB;&#x597D;&#x7684;&#x3002;&#x9996;&#x5148;&#x627E;&#x5230;&#x6E90;&#x7801;&#x7684;&#x4F4D;&#x7F6E;&#xFF1A;drviers/net/fec.c&#x5BF9;&#x5E94;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;fec.h&#x4F5C;&#x5934;&#x6587;&#x4EF6;&#xFF0C;&#x540C;&#x65F6;&#x73B0;&#x5728;&#x5927;&#x591A;&#x6570;&#x7684;MPU&#x8FD8;&#x96C6;&#x6210;&#x4E86;&#x652F;&#x6301;FEC1588&#x7684;&#x786C;&#x4EF6;&#x63A7;&#x5236;&#x5668;&#xFF0C;&#x4ECE;&#x786C;&#x4EF6;&#x4E0A;&#x652F;&#x6301;&#x4E00;&#x4E9B;&#x5BF9;&#x65F6;&#x95F4;&#x6709;&#x8981;&#x6C42;&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x6BD4;&#x5982;Ethernet AVB&#x7B49;&#x7B49;&#x3002;&#x8FD9;&#x91CC;&#x4EE5;<strong>3.0.35&#x5185;&#x6838;</strong>&#x76EE;&#x524D;&#x6700;&#x65B0;release&#x7684;<strong>LTIB 4.1.0</strong>&#x73AF;&#x5883;&#x7684;&#x5185;&#x6838;&#x4E3A;&#x53C2;&#x8003;&#x3002;</p>
<pre><code class="lang-c"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> __<span class="hljs-function">init
<span class="hljs-title">fec_enet_module_init</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
    printk(KERN_INFO <span class="hljs-string">&quot;FEC Ethernet Driver\n&quot;</span>);

    <span class="hljs-keyword">return</span> platform_driver_register(&amp;fec_driver);
}

<span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> __<span class="hljs-function"><span class="hljs-built_in">exit</span>
<span class="hljs-title">fec_enet_cleanup</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
    platform_driver_unregister(&amp;fec_driver);
}

module_exit(fec_enet_cleanup);
module_init(fec_enet_module_init);

MODULE_LICENSE(<span class="hljs-string">&quot;GPL&quot;</span>);
</code></pre>
<p>&#x73B0;&#x5728;&#x770B;&#x5230;printk&#x540E;&#x9762;&#x90A3;&#x4E2A;KERN_INFO&#x4E00;&#x70B9;&#x90FD;&#x4E0D;&#x89C9;&#x5F97;&#x522B;&#x626D;&#xFF0C;&#x5F53;&#x521D;&#x8FD8;&#x88AB;&#x5751;&#x4E86;&#x3002;</p>
<p>printk&#x6709;8&#x4E2A;loglevel,&#x5B9A;&#x4E49;&#x5728;<linux kernel.h="">&#x4E2D;&#xFF0C;&#x5176;&#x4E2D;&#x6570;&#x503C;&#x8303;&#x56F4;&#x4ECE;0&#x5230;7&#xFF0C;&#x6570;&#x503C;&#x8D8A;&#x5C0F;&#xFF0C;&#x4F18;&#x5148;&#x7EA7;&#x8D8A;&#x9AD8;&#x3002;</linux></p>
<pre><code class="lang-c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>    KERN_EMERG      <span class="hljs-string">&quot;&lt;0&gt;&quot;</span>      </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>    KERN_ALERT       <span class="hljs-string">&quot;&lt;1&gt;&quot;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>    KERN_CRIT <span class="hljs-string">&quot;&lt;2&gt;&quot;</span>      </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>    KERN_ERR    <span class="hljs-string">&quot;&lt;3&gt;&quot;</span>      </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>    KERN_WARNING <span class="hljs-string">&quot;&lt;4&gt;&quot;</span>      </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>    KERN_NOTICE     <span class="hljs-string">&quot;&lt;5&gt;&quot;</span>      </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>    KERN_INFO <span class="hljs-string">&quot;&lt;6&gt;&quot;</span>      </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>    KERN_DEBUG      <span class="hljs-string">&quot;&lt;7&gt;&quot;</span></span>
</code></pre>
<p>&#x9ED8;&#x8BA4;&#x5728;Ubuntu rootfs&#x4E0B;&#xFF0C;&#x4F18;&#x5148;&#x7EA7;&#x5927;&#x4E8E;4&#x624D;&#x4F1A;&#x663E;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x65E5;&#x5FD7;&#x7EA7;&#x522B;&#x7684;printk&#x8BED;&#x53E5;&#x9ED8;&#x8BA4;&#x91C7;&#x7528;&#x7684;&#x7EA7;&#x522B;&#x662F; DEFAULT_ MESSAGE_LOGLEVEL&#xFF08;&#x8FD9;&#x4E2A;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x662F;4&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x89E3;&#x91CA;&#x89C1;<a href="http://blog.sina.com.cn/s/blog_636a55070101i6sr.html&#xFF09;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x4E0D;&#x8BBE;&#x7F6E;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5728;&#x4E2D;&#x65AD;&#x4E0A;&#x662F;&#x770B;&#x4E0D;&#x5230;printk&#x6253;&#x5370;&#x7684;&#x8BED;&#x53E5;&#x7684;&#xFF0C;&#x4E0D;&#x8FC7;&#x5728;dmesg&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;echo" target="_blank">http://blog.sina.com.cn/s/blog_636a55070101i6sr.html&#xFF09;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x4E0D;&#x8BBE;&#x7F6E;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5728;&#x4E2D;&#x65AD;&#x4E0A;&#x662F;&#x770B;&#x4E0D;&#x5230;printk&#x6253;&#x5370;&#x7684;&#x8BED;&#x53E5;&#x7684;&#xFF0C;&#x4E0D;&#x8FC7;&#x5728;dmesg&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;echo</a> 8 &gt; /proc/sys/kernel/printk&#x6765;&#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x8F93;&#x51FA;&#x7684;&#x6700;&#x4F4E;&#x4F18;&#x5148;&#x7EA7;&#x3002;</p>
<pre><code class="lang-c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">fec_mac_addr_setup</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *mac_addr)</span>
</span>{
    <span class="hljs-keyword">char</span> *ptr, *p = mac_addr;
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> tmp;
    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, ret = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">while</span> (p &amp;&amp; (*p) &amp;&amp; i &lt; <span class="hljs-number">6</span>) {
        ptr = <span class="hljs-built_in">strchr</span>(p, <span class="hljs-string">&apos;:&apos;</span>);
        <span class="hljs-keyword">if</span> (ptr)
            *ptr++ = <span class="hljs-string">&apos;\0&apos;</span>;

        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strlen</span>(p)) {
            ret = strict_strtoul(p, <span class="hljs-number">16</span>, &amp;tmp);
            <span class="hljs-keyword">if</span> (ret &lt; <span class="hljs-number">0</span> || tmp &gt; <span class="hljs-number">0xff</span>)
                <span class="hljs-keyword">break</span>;
            macaddr[i++] = tmp;
        }
        p = ptr;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

__setup(<span class="hljs-string">&quot;fec_mac=&quot;</span>, fec_mac_addr_setup);
</code></pre>
<p>&#x8FD9;&#x91CC;&#x7684;__setup&#x662F;&#x7528;&#x6765;&#x4ECE;uboot&#x4F20;&#x7ED9;&#x5185;&#x6838;&#x7684;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x4E2D;&#x6355;&#x83B7;fec_mac&#xFF08;&#x5373;mac&#x5730;&#x5740;&#xFF09;&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x5C06;&#x8BE5;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;fec_mac_addr_setup(char *mac_addr)&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#x3002;&#x5177;&#x4F53;&#x5185;&#x6838;&#x53C2;&#x6570;&#x89E3;&#x6790;&#x7684;&#x7EC6;&#x8282;&#x4E0E;&#x5185;&#x5E55;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x300A;Embedded Linux Primer: A Practical Real-World Approach&#x300B;Christopher Hallinan &#xFF08;&#x8BD1;&#x672C;&#x300A;&#x5D4C;&#x5165;&#x5F0F;Linux&#x57FA;&#x7840;&#x6559;&#x7A0B;&#x300B;&#xFF09;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x662F;fec_driver&#x7ED3;&#x6784;&#x4F53;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">static</span> <span class="hljs-keyword">struct</span> platform_driver fec_driver = {
    .driver    = {
        .name    = DRIVER_NAME,
        .owner    = THIS_MODULE,
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> CONFIG_PM</span>
        .pm    = &amp;fec_pm_ops,
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
    },
    .id_table = fec_devtype,
    .probe    = fec_probe,
    .remove    = __devexit_p(fec_drv_remove),
};
</code></pre>
<p>&#x8FD9;&#x91CC;&#x51FA;&#x4E86;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;.name,.owner,.probe,.remove&#x4EE5;&#x5916;&#xFF0C;&#x8FD8;&#x591A;&#x4E86;.pm&#xFF08;power management&#xFF09;&#x7ED3;&#x6784;&#x4F53;&#x3002;&#x8FD9;&#x91CC;&#x5173;&#x4E8E;__devexit_p&#x5B8F;&#x6211;&#x4E0D;&#x5F97;&#x4E0D;&#x63D2;&#x5634;&#xFF0C;&#x6BCF;&#x6B21;&#x90FD;&#x80FD;&#x89C1;&#x5230;&#x7C7B;&#x4F3C;&#x5730;&#xFF0C;&#x4F46;&#x662F;&#x4ECE;&#x6765;&#x6CA1;&#x6709;&#x60F3;&#x8FC7;&#x5230;&#x5E95;&#x6709;&#x4EC0;&#x4E48;&#x7528;&#xFF0C;&#x5B83;&#x5B9A;&#x4E49;&#x5728;include/linux/init.h&#x4E2D;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-comment">/* Functions marked as __devexit may be discarded at kernel link time, depending
   on config options.  Newer versions of binutils detect references from
   retained sections to discarded sections and flag an error.  Pointers to
   __devexit functions must use __devexit_p(function_name), the wrapper will
   insert either the function_name or NULL, depending on the config options.
 */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(MODULE) || defined(CONFIG_HOTPLUG)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __devexit_p(x) x</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __devexit_p(x) NULL</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre>
<p>&#x770B;&#x5B8C;&#x8FD9;&#x4E00;&#x6BB5;&#x5E94;&#x8BE5;&#x4E0D;&#x7528;&#x6211;&#x89E3;&#x91CA;&#x4E86;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x8981;&#x8BB2;.id_table&#x5B57;&#x6BB5;&#x3002;&#x6307;&#x9488;&#x6307;&#x5411;&#x7684;&#x7ED3;&#x6784;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-c"> <span class="hljs-keyword">static</span> <span class="hljs-keyword">struct</span> platform_device_id fec_devtype[] = {
    {
        .name = <span class="hljs-string">&quot;enet&quot;</span>,
        .driver_data = FEC_QUIRK_ENET_MAC | FEC_QUIRK_BUG_TKT168103,
    },
    {
        .name = <span class="hljs-string">&quot;fec&quot;</span>,
        .driver_data = <span class="hljs-number">0</span>,
    },
    {
        .name = <span class="hljs-string">&quot;imx28-fec&quot;</span>,
        .driver_data = FEC_QUIRK_ENET_MAC | FEC_QUIRK_SWAP_FRAME |
                FEC_QUIRK_BUG_TKT168103,
    },
    { }
};
</code></pre>
<p>&#x8FD9;&#x91CC;&#x7684;fec_devtype[]&#x6570;&#x7EC4;&#x4E3B;&#x8981;&#x662F;&#x7528;&#x6765;&#x8FDB;&#x884C;device&#x4E0E;driver&#x7684;&#x5339;&#x914D;&#xFF0C;&#x5728;2.6&#x6A21;&#x578B;&#x4E2D;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x6539;&#x8FDB;&#x5C31;&#x662F;&#x8BBE;&#x5907;&#x6A21;&#x578B;&#x3002;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x4EE5;device&#x7684;&#x540D;&#x5B57;&#x548C;driver&#x7684;&#x540D;&#x5B57;&#x76F8;&#x540C;&#x5373;&#x5339;&#x914D;&#x6210;&#x529F;&#xFF0C;&#x4F46;&#x771F;&#x6B63;platform bus&#x7684;&#x5339;&#x914D;&#x51FD;&#x6570;&#x5728;drivers/base/platform.c&#x4E2D;&#x5B9A;&#x4E49;&#xFF0C;&#x9996;&#x5148;&#x53EF;&#x4EE5;&#x770B;&#x5230;platform_bus_type&#x662F;bus_type&#x7684;&#x5B9E;&#x4F8B;&#x5316;&#x3002;&#x5176;&#x4E2D;&#x7684;.match&#x51FD;&#x6570;&#x5373;&#x662F;&#x7528;&#x6765;&#x5339;&#x914D;&#x7684;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">platform_match</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> device *dev, <span class="hljs-keyword">struct</span> device_driver *drv)</span>
</span>{
    <span class="hljs-keyword">struct</span> platform_device *pdev = to_platform_device(dev);
    <span class="hljs-keyword">struct</span> platform_driver *pdrv = to_platform_driver(drv);

    <span class="hljs-comment">/* Attempt an OF style match first */</span>
    <span class="hljs-keyword">if</span> (of_driver_match_device(dev, drv))
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;

    <span class="hljs-comment">/* Then try to match against the id table */</span>
    <span class="hljs-keyword">if</span> (pdrv-&gt;id_table)
        <span class="hljs-keyword">return</span> platform_match_id(pdrv-&gt;id_table, pdev) != <span class="hljs-literal">NULL</span>;

    <span class="hljs-comment">/* fall-back to driver name match */</span>
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">strcmp</span>(pdev-&gt;name, drv-&gt;name) == <span class="hljs-number">0</span>);
}
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5339;&#x914D;&#x6709;&#x4E09;&#x4E2A;&#x6761;&#x4EF6;&#xFF1A;</p>
<p>1&#xFF09;&#x5982;&#x679C;&#x5185;&#x6838;&#x5F00;&#x542F;&#x4E86;&#x8BBE;&#x5907;&#x6811;&#x652F;&#x6301;&#x7684;&#x8BDD;&#x4F18;&#x5148;&#x5339;&#x914D;&#x8BBE;&#x5907;&#x6811;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5BFB;&#x627E;.driver &#x4E2D;&#x7684;.of_match_table&#x5339;&#x914D;&#x8868;&#x662F;&#x5426;&#x4E0E;&#x8BBE;&#x5907;&#x6811;&#x4E2D;&#x8BBE;&#x5907;&#x7ED3;&#x70B9;&#x7684;.compatible&#x503C;&#x76F8;&#x540C;&#xFF0C;&#x662F;&#x5219;&#x5339;&#x914D;&#x6210;&#x529F;&#x3002;</p>
<p>2&#xFF09;&#x4F7F;&#x7528;&#x9A71;&#x52A8;&#x4E2D;&#x7684;.id_table&#x5217;&#x8868;&#x5339;&#x914D;&#xFF0C;&#x5728;id_table&#x6570;&#x7EC4;&#x4E2D;&#x5BFB;&#x627E;&#x4E0E;device&#x7684;&#x540D;&#x5B57;&#x76F8;&#x5339;&#x914D;&#x7684;&#x6210;&#x5458;&#x3002;</p>
<p>3&#xFF09;&#x6700;&#x540E;&#x5355;&#x7EAF;&#x5730;&#x6BD4;&#x8F83;device&#x7684;&#x540D;&#x5B57;&#x548C;driver&#x7684;&#x540D;&#x5B57;&#x662F;&#x5426;&#x76F8;&#x540C;&#xFF0C;&#x662F;&#x5219;&#x5339;&#x914D;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x3002;</p>
<p>&#x770B;&#x5B8C;driver&#x770B;device&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x770B;&#x770B;&#x677F;&#x7EA7;&#x4FE1;&#x606F;&#x662F;&#x5728;&#x54EA;&#x91CC;&#x6DFB;&#x52A0;&#x7684;&#x5427;&#xFF08;&#x6211;&#x627E;&#x7684;&#x6BD4;&#x8F83;&#x7EA0;&#x7ED3;&#xFF09;&#x3002;</p>
<p>&#x5728;arch/arm/mach-mx6/board-mx6q_sabresd.c&#x6587;&#x4EF6;&#x4E2D;&#x7684;mx6_sabresd_board_init()&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x627E;&#x5230;imx6_init_fec(fec_data);&#x8FD9;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x5373;&#x4E3A;&#x6DFB;&#x52A0;&#x4EE5;&#x592A;&#x7F51;device&#x7684;&#x4EE3;&#x7801;&#x3002;&#x800C;mx6_sabresd_board_init&#x51FD;&#x6570;&#x5728;MACHINE_START()&#x51FD;&#x6570;&#x4E2D;&#x88AB;&#x521D;&#x59CB;&#x5316;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-comment">/*
 * initialize __mach_desc_MX6Q_SABRESD data structure.
 */</span>
MACHINE_START(MX6Q_SABRESD, <span class="hljs-string">&quot;Freescale i.MX 6Quad/DualLite/Solo Sabre-SD Board&quot;</span>)
    <span class="hljs-comment">/* Maintainer: Freescale Semiconductor, Inc. */</span>
    .boot_params = MX6_PHYS_OFFSET + <span class="hljs-number">0x100</span>,
    .fixup = fixup_mxc_board,
    .map_io = mx6_map_io,
    .init_irq = mx6_init_irq,
    .init_machine = mx6_sabresd_board_init,
    .timer = &amp;mx6_sabresd_timer,
    .reserve = mx6q_sabresd_reserve,
MACHINE_END
</code></pre>
<p>ARM&#x542F;&#x52A8;&#x521D;&#x59CB;&#x5316;&#x90E8;&#x5206;&#x7684;&#x4EE3;&#x7801;&#x4EE5;&#x540E;&#x6709;&#x65F6;&#x95F4;&#x518D;&#x6162;&#x6162;&#x5206;&#x6790;&#xFF0C;&#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x662F;&#x9488;&#x5BF9;Sabre-SD Board&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x8C03;&#x7528;&#x4E00;&#x7CFB;&#x5217;&#x51FD;&#x6570;&#x3002;&#x4E0B;&#x9762;&#x5206;&#x6790;imx6_init_fec(fec_data);</p>
<p>&#x5B9A;&#x4E49;&#x5728;arch/arm/mach-mx6/mx6_fec.c</p>
<pre><code class="lang-c"><span class="hljs-keyword">void</span> __<span class="hljs-function">init <span class="hljs-title">imx6_init_fec</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> fec_platform_data fec_data)</span>
</span>{
    fec_get_mac_addr(fec_data.mac);
    <span class="hljs-keyword">if</span> (!is_valid_ether_addr(fec_data.mac))
        random_ether_addr(fec_data.mac);


    <span class="hljs-keyword">if</span> (cpu_is_mx6sl())
        imx6sl_add_fec(&amp;fec_data);
    <span class="hljs-keyword">else</span>
        imx6q_add_fec(&amp;fec_data);
}
</code></pre>
<p>&#x8FD9;&#x91CC;struct fec_platform_data fec_data&#x662F;&#x8BBE;&#x5907;&#x7684;&#x79C1;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x5B9A;&#x4E49;&#x5728;include/linux/fec.h&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">struct</span> fec_platform_data {
    <span class="hljs-keyword">int</span> (*init) (<span class="hljs-keyword">struct</span> phy_device *);
    <span class="hljs-keyword">int</span> (*power_hibernate) (<span class="hljs-keyword">struct</span> phy_device *);
    <span class="hljs-keyword">phy_interface_t</span> phy;
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> mac[ETH_ALEN];
    <span class="hljs-keyword">int</span> gpio_irq;
};
</code></pre>
<p>&#x800C;&#x8FD9;&#x91CC;&#x7684;fec_data&#x662F;&#x5DF2;&#x7ECF;&#x5728;arch/arm/mach-mx6/board-mx6q_sabresd.c&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x597D;&#x7684;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">static</span> <span class="hljs-keyword">struct</span> fec_platform_data fec_data __initdata = {
    .init = mx6q_sabresd_fec_phy_init,
    .phy = PHY_INTERFACE_MODE_RGMII,
    .gpio_irq = MX6_ENET_IRQ,
};
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;imx6_init_fec()&#x6700;&#x540E;&#x662F;&#x6267;&#x884C;imx6q_add_fec(&amp;fec_data)&#x6DFB;&#x52A0;&#x8BBE;&#x5907;&#xFF0C;&#x5B9A;&#x4E49;&#x5728;arch/arm/mach-mx6/devices-imx6q.h&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> imx_fec_data imx6q_fec_data __initconst;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> imx6q_add_fec(pdata)    \
    imx_add_fec(&amp;imx6q_fec_data, pdata)</span>
</code></pre>
<p>&#x8FD9;&#x91CC;&#x5F15;&#x7528;&#x4E86;&#x5916;&#x90E8;&#x7684;imx6q_fec_data&#xFF0C;&#x5B9A;&#x4E49;&#x5728;arch/arm/plat-mxc/devices/platform-fec.c&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> CONFIG_SOC_IMX6Q</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> imx_fec_data imx6q_fec_data __initconst =
    imx_fec_data_entry_single(MX6Q, <span class="hljs-string">&quot;enet&quot;</span>);


<span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> imx_fec_data imx6sl_fec_data __initconst =
    imx_fec_data_entry_single(MX6DL, <span class="hljs-string">&quot;fec&quot;</span>);
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre>
<p>&#x770B;&#x5230;&#x201C;enet&#x201D;&#x5B57;&#x6BB5;&#x5C31;&#x77E5;&#x9053;&#x79BB;&#x6700;&#x7EC8;&#x4EE3;&#x7801;&#x4E0D;&#x8FDC;&#x4E86;&#xFF0C;&#x800C;imx_fec_data_entry_single&#x540C;&#x6837;&#x5B9A;&#x4E49;&#x5728;&#x8BE5;&#x6587;&#x4EF6;&#x5185;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> imx_fec_data_entry_single(soc, _devid)                \
    {                                \
        .iobase = soc ## _FEC_BASE_ADDR,            \
        .irq = soc ## _INT_FEC,                    \
        .devid = _devid,                    \
    }</span>
</code></pre>
<p>&#x8FD9;&#x91CC;&#x7684;&#x8FDE;&#x7EED;&#x4E24;&#x4E2A;&#x4E95;&#x53F7;##&#x7528;&#x4E8E;&#x628A;&#x524D;&#x540E;&#x7684;&#x5B57;&#x6BCD;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x540D;&#xFF0C;&#x4E95;&#x53F7;&#x5DE6;&#x53F3;&#x7684;&#x7A7A;&#x683C;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;&#x3002;&#x56E0;&#x6B64;&#x4E0A;&#x9762;&#x7684;&#x5B9A;&#x4E49;&#x5C55;&#x5F00;&#x4EE5;&#x540E;&#x5C31;&#x662F;</p>
<p>#define imx_fec_data_entry_single(MX6Q, &quot;enet&quot;)</p>
<p>&#x200B;    {</p>
<p>&#x200B;        .iobase = MX6Q_FEC_BASE_ADDR,</p>
<p>&#x200B;        .irq = MX6Q_INT_FEC,</p>
<p>&#x200B;        .devid = &quot;enet&quot;,</p>
<p>&#x200B;    }</p>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x5B8F;&#x53EF;&#x4EE5;&#x5728;arch/arm/plat-mxc/include/mach/mx6.h&#x4E2D;&#x627E;&#x5230;&#x5B83;&#x4EEC;&#x5177;&#x4F53;&#x7684;&#x503C;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7EE7;&#x7EED;&#x5206;&#x6790;imx_add_fec(&amp;imx6q_fec_data, pdata),&#x5B9A;&#x4E49;&#x5728;arch/arm/plat-mxc/devices/platform-fec.c&#x4E2D;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">struct</span> platform_device *__<span class="hljs-function">init <span class="hljs-title">imx_add_fec</span><span class="hljs-params">(
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> imx_fec_data *data,
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> fec_platform_data *pdata)</span>
</span>{
    <span class="hljs-keyword">struct</span> resource res[] = {
        {
            .start = data-&gt;iobase,
            .end = data-&gt;iobase + SZ_4K - <span class="hljs-number">1</span>,
            .flags = IORESOURCE_MEM,
        }, {
            .start = data-&gt;irq,
            .end = data-&gt;irq,
            .flags = IORESOURCE_IRQ,
        },
    };


    <span class="hljs-keyword">if</span> (!fuse_dev_is_available(MXC_DEV_ENET))
        <span class="hljs-keyword">return</span> ERR_PTR(-ENODEV);


    <span class="hljs-keyword">return</span> imx_add_platform_device_dmamask(data-&gt;devid, <span class="hljs-number">0</span>,
            res, ARRAY_SIZE(res),
            pdata, <span class="hljs-keyword">sizeof</span>(*pdata), DMA_BIT_MASK(<span class="hljs-number">32</span>));
}
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;imx_fec_data&#x7684;&#x503C;&#x6700;&#x7EC8;&#x90FD;&#x88AB;&#x4F20;&#x9012;&#x7ED9;&#x4E86;resource&#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;imx_add_platform_device_dmamask()&#x51FD;&#x6570;&#x6765;&#x5C06;resource&#x548C;&#x989D;&#x5916;&#x7684;pdata&#x6570;&#x636E;&#x6DFB;&#x52A0;&#x5230;device&#x4E2D;&#xFF0C;&#x6700;&#x540E;&#x5728;driver&#x4E2D;&#x83B7;&#x53D6;device&#x7684;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x5206;&#x6790;&#x5B8C;device&#x7684;&#x6DFB;&#x52A0;&#x4E0E;driver&#x7684;&#x52A0;&#x8F7D;&#x4E4B;&#x540E;&#x5C31;&#x5230;&#x4E86;probe&#x5165;&#x53E3;&#x51FD;&#x6570;&#xFF1A;</p>
<p>static int __devinit fec_probe(struct platform_device *pdev)</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E3B;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x5C31;&#x662F;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x9996;&#x5148;&#x662F;&#x83B7;&#x53D6;&#x4E4B;&#x524D;&#x5728;&#x8BBE;&#x5907;&#x4E2D;&#x6DFB;&#x52A0;&#x7684;resource&#x5C5E;&#x6027;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x7533;&#x8BF7;&#x8BE5;&#x6BB5;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x7684;&#x5360;&#x7528;&#xFF1A;</p>
<pre><code class="lang-c">r = platform_get_resource(pdev, IORESOURCE_MEM, <span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span> (!r)
    <span class="hljs-keyword">return</span> -ENXIO;


r = request_mem_region(r-&gt;start, resource_size(r), pdev-&gt;name);
<span class="hljs-keyword">if</span> (!r)
    <span class="hljs-keyword">return</span> -EBUSY;
</code></pre>
<p>&#x4E0B;&#x9762;&#x8C03;&#x7528;&#x5185;&#x6838;&#x63D0;&#x4F9B;&#x7684;api&#x51FD;&#x6570;alloc_etherdev()&#x521D;&#x59CB;&#x5316;&#x7F51;&#x7EDC;&#x8BBE;&#x5907;&#xFF0C;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x662F;driver&#x7684;&#x79C1;&#x6709;&#x6570;&#x636E;&#x5C3A;&#x5BF8;&#xFF0C;&#x7528;&#x4E8E;&#x989D;&#x5916;&#x5206;&#x914D;driver&#x7684;&#x79C1;&#x6709;&#x6570;&#x636E;&#x3002;</p>
<pre><code class="lang-c"><span class="hljs-comment">/* Init network device */</span>
ndev = alloc_etherdev(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">struct</span> fec_enet_private));
<span class="hljs-keyword">if</span> (!ndev) {
    ret = -ENOMEM;
    <span class="hljs-keyword">goto</span> failed_alloc_etherdev;
}
</code></pre>
<p>&#x63A5;&#x4E0B;&#x6765;&#x544A;&#x8BC9;&#x5185;&#x6838;&#x6211;&#x4EEC;&#x7684;&#x8BBE;&#x5907;&#x5C5E;&#x4E8E;&#x7F51;&#x7EDC;&#x8BBE;&#x5907;&#xFF0C;&#x7531;&#x4E8E;netdevice&#x4E0D;&#x5C5E;&#x4E8E;char&#x6216;&#x8005;block&#x8BBE;&#x5907;&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x80FD;&#x7528;&#x5E38;&#x89C4;&#x7684;&#x9A71;&#x52A8;&#x65B9;&#x6CD5;&#x6765;&#x8BBE;&#x8BA1;&#xFF1A;</p>
<pre><code class="lang-c">SET_NETDEV_DEV(ndev, &amp;pdev-&gt;dev);
&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;
<span class="hljs-comment">/* Set the sysfs physical device reference for the network logical device * if set prior to registration will cause a symlink during initialization. 
*/</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SET_NETDEV_DEV(net, pdev)    ((net)-&gt;dev.parent = (pdev))</span>
</code></pre>
<p>&#x5206;&#x914D;&#x5B8C;netdevice&#x4EE5;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x7684;&#x51FD;&#x6570;&#x83B7;&#x53D6;&#x6307;&#x5411;&#x5206;&#x914D;&#x7684;&#x79C1;&#x6709;&#x6570;&#x636E;&#x7684;&#x6307;&#x9488;&#x3002;</p>
<pre><code class="lang-c"><span class="hljs-comment">/* setup board info structure */</span>fep = netdev_priv(ndev);
</code></pre>
<p>&#x4E0B;&#x9762;&#x7528;ioremap&#x6620;&#x5C04;&#xFF0C;&#x5EFA;&#x7ACB;&#x5185;&#x6838;&#x5230;&#x5BC4;&#x5B58;&#x5668;&#x7269;&#x7406;&#x5730;&#x5740;&#x7684;&#x9875;&#x8868;&#xFF0C;&#x4EE5;&#x53CA;&#x7ED9;platform_device&#x6307;&#x9488;&#x8D4B;&#x503C;&#x3002;</p>
<pre><code class="lang-c">fep-&gt;hwp = ioremap(r-&gt;start, resource_size(r));
fep-&gt;pdev = pdev;


<span class="hljs-keyword">if</span> (!fep-&gt;hwp) {
    ret = -ENOMEM;
    <span class="hljs-keyword">goto</span> failed_ioremap;
}
</code></pre>
<p>&#x63A5;&#x7740;&#x8BBE;&#x7F6E;platform driver&#x7684;&#x79C1;&#x6709;&#x6570;&#x636E;</p>
<pre><code class="lang-c">platform_set_drvdata(pdev, ndev);
</code></pre>
<p>&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x6700;&#x7EC8;&#x662F;&#x4F5C;&#x4E86;pdev-&gt;dev-&gt;p-&gt;driver_data = ndev&#x7684;&#x6307;&#x9488;&#x6307;&#x5411;&#x3002;</p>
<p>&#x7136;&#x540E;&#x662F;&#x63A5;&#x6536;&#x4E4B;&#x524D;&#x5728;mach-mx6&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x9759;&#x6001;&#x6DFB;&#x52A0;device&#x7684;platform_data&#xFF1A;</p>
<pre><code class="lang-c">pdata = pdev-&gt;dev.platform_data;
</code></pre>
<p>&#x63A5;&#x7740;&#x662F;&#x5BF9;pdata&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">if</span> (pdata)    fep-&gt;phy_interface = pdata-&gt;phy;
</code></pre>
<p>&#x8FD9;&#x91CC;&#x7684;phy&#x662F;&#x7528;&#x6765;&#x5224;&#x65AD;MAC&#x5C42;&#x548C;&#x4EE5;&#x592A;&#x7F51;&#x7269;&#x7406;&#x5C42;&#x7684;&#x63A5;&#x53E3;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;MX6Q&#x7684;&#x63A5;&#x53E3;&#x662F;PHY_INTERFACE_MODE_RGMII&#xFF0C;&#x4E5F;&#x5C31;&#x662F;RGMII&#xFF0C;&#x5343;&#x5146;&#x4EE5;&#x592A;&#x7F51;&#x63A5;&#x53E3;&#x3002;&#x7136;&#x540E;&#x662F;&#x83B7;&#x53D6;&#x4EE5;&#x592A;&#x7F51;&#x63A7;&#x5236;&#x5668;&#x5BF9;&#x5E94;&#x7684;</p>
<pre><code class="lang-c"><span class="hljs-keyword">if</span> (pdata-&gt;gpio_irq &gt; <span class="hljs-number">0</span>) {
    gpio_request(pdata-&gt;gpio_irq, <span class="hljs-string">&quot;gpio_enet_irq&quot;</span>);
    gpio_direction_input(pdata-&gt;gpio_irq);

    irq = gpio_to_irq(pdata-&gt;gpio_irq);
    ret = request_irq(irq, fec_enet_interrupt,
            IRQF_TRIGGER_RISING,
             pdev-&gt;name, ndev);
    <span class="hljs-keyword">if</span> (ret)
        <span class="hljs-keyword">goto</span> failed_irq;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">/* This device has up to three irqs on some platforms */</span>
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
        irq = platform_get_irq(pdev, i);
        <span class="hljs-keyword">if</span> (i &amp;&amp; irq &lt; <span class="hljs-number">0</span>)
            <span class="hljs-keyword">break</span>;
        ret = request_irq(irq, fec_enet_interrupt,
                IRQF_DISABLED, pdev-&gt;name, ndev);
        <span class="hljs-keyword">if</span> (ret) {
            <span class="hljs-keyword">while</span> (--i &gt;= <span class="hljs-number">0</span>) {
                irq = platform_get_irq(pdev, i);
                free_irq(irq, ndev);
            }
            <span class="hljs-keyword">goto</span> failed_irq;
        }
    }
}
</code></pre>
<p>&#x8FD9;&#x91CC;&#x7528;&#x4E8E;&#x5224;&#x65AD;Ethernet&#x7684;&#x4E2D;&#x65AD;&#x4F7F;&#x7528;gpio&#x8FB9;&#x6CBF;&#x51FA;&#x53D1;&#x7684;&#x4E2D;&#x65AD;&#x8FD8;&#x662F;&#x4ECE;platform device&#x7684;resource&#x4F20;&#x8FC7;&#x6765;&#x7684;&#x4E2D;&#x65AD;&#x53F7;&#x3002;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x770B;&#x5230;&#x4F20;&#x9012;&#x7ED9;driver&#x7684;&#x79C1;&#x6709;&#x6570;&#x636E;fec_data&#x5DF2;&#x7ECF;&#x88AB;&#x9759;&#x6001;&#x5730;&#x521D;&#x59CB;&#x5316;&#x4E3A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">static</span> <span class="hljs-keyword">struct</span> fec_platform_data fec_data __initdata = {
    .init = mx6q_sabresd_fec_phy_init,
    .phy = PHY_INTERFACE_MODE_RGMII,
    .gpio_irq = MX6_ENET_IRQ,
};
</code></pre>
<p>&#x8FD9;&#x91CC;MX6_ENET_IRQ&#x7684;&#x503C;&#x662F;6&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x6DFB;&#x52A0;&#x79C1;&#x6709;&#x6570;&#x636E;&#x524D;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x4E0B;&#x9762;&#x8FD9;&#x53E5;&#x8BDD;&#xFF0C;</p>
<pre><code class="lang-c"><span class="hljs-keyword">if</span> (enet_to_gpio_6)
        <span class="hljs-comment">/* Make sure the IOMUX_OBSRV_MUX1 is set to ENET_IRQ. */</span>
    mxc_iomux_set_specialbits_register(
        IOMUX_OBSRV_MUX1_OFFSET,
        OBSRV_MUX1_ENET_IRQ,
        OBSRV_MUX1_MASK);
<span class="hljs-keyword">else</span>
    fec_data.gpio_irq = <span class="hljs-number">-1</span>;
imx6_init_fec(fec_data);
</code></pre>
<p>&#x7528;&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5BF9;fec_data&#x7684;gpio_irq&#x5B57;&#x6BB5;&#x8D4B;&#x503C;-1&#xFF0C;&#x800C;enet_to_gpio_6&#x662F;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x5B9A;&#x4E49;&#x5728;arch/arm/mach-mx6/cpu.c&#x4E2D;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;0&#xFF0C;&#x540C;&#x6837;&#x5728;&#x8BE5;c&#x6587;&#x4EF6;&#x4E2D;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> __<span class="hljs-function">init <span class="hljs-title">set_enet_irq_to_gpio</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *p)</span>
</span>{
    enet_to_gpio_6 = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}


early_param(<span class="hljs-string">&quot;enet_gpio_6&quot;</span>, set_enet_irq_to_gpio);
</code></pre>
<p>early_param&#x7528;&#x6765;&#x89E3;&#x6790;uboot&#x4F20;&#x9012;&#x7ED9;&#x5185;&#x6838;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x53C2;&#x6570;&#x4E2D;&#x51FA;&#x73B0;&#x201C;enet_gpio_6&#x201D;&#x5B57;&#x6BB5;&#x65F6;&#xFF0C;&#x624D;&#x4F1A;&#x8C03;&#x7528;set_enet_irq_to_gpio&#xFF0C;&#x90A3;&#x4E48;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x5426;&#x8C03;&#x7528;&#x662F;&#x53D6;&#x51B3;&#x4E8E;&#x8FD0;&#x884C;&#x65F6;uboot&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;MX6Q&#x7684;uboot&#x662F;&#x4E0D;&#x5E26;&#x6709;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#x5B9E;&#x9645;&#x6267;&#x884C;&#x65F6;&#xFF0C;gpio_irq = -1&#x3002;&#x6240;&#x4EE5;&#x4E0A;&#x9762;&#x7684;if(pdata-&gt;gpio_irq &gt; 0) {}&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#xFF0C;&#x800C;&#x662F;&#x6267;&#x884C;else&#x5206;&#x652F;&#xFF0C;&#x5373;&#x5B9E;&#x9645;&#x4ECE;platform device&#x7684;resource&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7684;&#x4FE1;&#x606F;&#x4E2D;&#x83B7;&#x53D6;irq&#x53F7;&#xFF0C;&#x4ECE;&#x524D;&#x9762;&#x7684;&#x5206;&#x6790;&#x53EF;&#x4EE5;&#x77E5;&#x9053;IRQ&#x53F7;&#x88AB;&#x5B9A;&#x4E49;&#x6210;&#x5B8F;MX6Q_INT_FEC&#xFF0C;&#x5373;150&#x53F7;&#x4E2D;&#x65AD;&#xFF0C;&#x800C;&#x5177;&#x4F53;irq&#x7684;&#x521D;&#x59CB;&#x5316;&#x8FC7;&#x7A0B;&#x6709;&#x65F6;&#x95F4;&#x6211;&#x518D;&#x5199;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x5427;&#x3002;&#x5BF9;&#x5E94;&#x7684;&#x4E2D;&#x65AD;&#x6CE8;&#x518C;&#x51FD;&#x6570;&#x662F;fec_enet_interrupt()&#x3002;</p>
<p>&#x4E2D;&#x65AD;&#x5904;&#x7406;&#x5B8C;&#x4E86;&#x4E4B;&#x540E;&#x5C31;&#x5230;&#x4E86;&#x65F6;&#x949F;&#x4E86;&#xFF0C;linux&#x5185;&#x6838;&#x6709;&#x4E00;&#x7EC4;&#x4E13;&#x95E8;&#x7684;clock api&#x7528;&#x6765;&#x5904;&#x7406;&#x65F6;&#x949F;&#xFF0C;&#x7B80;&#x5355;&#x70B9;&#x6765;&#x8BF4;&#x5C31;&#x53EA;&#x8981;&#x77E5;&#x9053;&#x9996;&#x5148;clk_get()&#x7136;&#x540E;&#x518D;clk_enable()&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;driver remove&#x7684;&#x65F6;&#x5019;&#x53CD;&#x4E4B;&#x5373;clk_disable()&#x518D;clk_put()</p>
<p>&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x65F6;&#x949F;&#x6846;&#x67B6;&#x6211;&#x6709;&#x65F6;&#x95F4;&#x518D;&#x5199;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#xFF0C;&#x73B0;&#x5728;linux&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x5957;&#x5168;&#x65B0;&#x7684;CCF&#x6846;&#x67B6;&#xFF08;Common Clock Framework&#xFF09;&#xFF0C;&#x8D44;&#x6599;&#x4E5F;&#x5927;&#x591A;&#x6570;&#x4E3A;&#x82F1;&#x6587;&#x3002;</p>
<pre><code class="lang-c">fep-&gt;clk = clk_get(&amp;pdev-&gt;dev, <span class="hljs-string">&quot;fec_clk&quot;</span>);
<span class="hljs-keyword">if</span> (IS_ERR(fep-&gt;clk)) {
    ret = PTR_ERR(fep-&gt;clk);
    <span class="hljs-keyword">goto</span> failed_clk;
}
fep-&gt;mdc_clk = clk_get(&amp;pdev-&gt;dev, <span class="hljs-string">&quot;fec_mdc_clk&quot;</span>);
<span class="hljs-keyword">if</span> (IS_ERR(fep-&gt;mdc_clk)) {
    ret = PTR_ERR(fep-&gt;mdc_clk);
    <span class="hljs-keyword">goto</span> failed_clk;
}
clk_enable(fep-&gt;clk);
</code></pre>
<p>&#x8FD9;&#x91CC;fec_clk&#x6307;&#x7684;&#x662F;Ethernet&#x63A7;&#x5236;&#x5668;&#x7684;clock&#xFF0C;&#x800C;fec_mdc_clk&#x6307;&#x7684;&#x662F;MAC&#x5C42;&#x4E0E;&#x7269;&#x7406;&#x5C42;&#x63A5;&#x53E3;MDIO&#x7684;Clock&#x3002;&#x7D27;&#x63A5;&#x7740;&#x5C31;&#x5230;&#x4E86;MAC&#x5C42;&#x7684;&#x521D;&#x59CB;&#x5316;&#x51FD;&#x6570;&#xFF1A;</p>
<pre><code class="lang-c">ret = fec_enet_init(ndev);
<span class="hljs-keyword">if</span> (ret)
    <span class="hljs-keyword">goto</span> failed_init;
</code></pre>
<p>&#x518D;&#x63A5;&#x7740;&#x5C31;&#x662F;MAC&#x5C42;&#x4E0E;&#x7269;&#x7406;&#x5C42;&#x63A5;&#x53E3;&#x7684;&#x521D;&#x59CB;&#x5316;&#x51FD;&#x6570;&#xFF1A;</p>
<pre><code class="lang-c">ret = fec_enet_mii_init(pdev);
<span class="hljs-keyword">if</span> (ret)
    <span class="hljs-keyword">goto</span> failed_mii_init;
</code></pre>
<p>&#x518D;&#x63A5;&#x7740;&#x5C31;&#x662F;&#x5BF9;IEEE 1588 &#x65F6;&#x949F;&#x540C;&#x6B65;&#x534F;&#x8BAE;&#x7684;&#x521D;&#x59CB;&#x5316;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-keyword">if</span> (fec_ptp_malloc_priv(&amp;(fep-&gt;ptp_priv))) {
    <span class="hljs-keyword">if</span> (fep-&gt;ptp_priv) {
        fep-&gt;ptp_priv-&gt;hwp = fep-&gt;hwp;
        ret = fec_ptp_init(fep-&gt;ptp_priv, pdev-&gt;id);
        <span class="hljs-keyword">if</span> (ret)
            printk(KERN_WARNING <span class="hljs-string">&quot;IEEE1588: ptp-timer is unavailable\n&quot;</span>);
        <span class="hljs-keyword">else</span>
            fep-&gt;ptimer_present = <span class="hljs-number">1</span>;
    } <span class="hljs-keyword">else</span>
        printk(KERN_ERR <span class="hljs-string">&quot;IEEE1588: failed to malloc memory\n&quot;</span>);
}
</code></pre>
<p>&#x7136;&#x540E;&#x628A;&#x5185;&#x6838;&#x7F51;&#x7EDC;&#x5C42;&#x7684;&#x4F20;&#x8F93;&#x961F;&#x5217;&#x5173;&#x95ED;&#xFF08;&#x5373;&#x7981;&#x6B62;&#x53D1;&#x9001;&#xFF09;&#xFF0C;&#x5173;&#x95ED;&#x65F6;&#x949F;&#xFF0C;&#x7B49;&#x4E00;&#x4E9B;&#x5217;&#x8F85;&#x52A9;&#x64CD;&#x4F5C;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-comment">/* Carrier starts down, phylib will bring it up */</span>
netif_carrier_off(ndev);
clk_disable(fep-&gt;clk);


INIT_DELAYED_WORK(&amp;fep-&gt;fixup_trigger_tx, fixup_trigger_tx_func);
</code></pre>
<p>&#x6700;&#x540E;&#x4E5F;&#x662F;&#x6700;&#x91CD;&#x8981;&#x6B65;&#x9AA4;&#xFF0C;&#x5373;&#x5411;&#x5185;&#x6838;&#x6CE8;&#x518C;&#x4E4B;&#x524D;&#x5206;&#x914D;&#x7684;net_device&#xFF1A;</p>
<pre><code class="lang-c">ret = register_netdev(ndev);
<span class="hljs-keyword">if</span> (ret)
    <span class="hljs-keyword">goto</span> failed_register;
</code></pre>
<p>&#x63A5;&#x4E0B;&#x6765;&#x5C06;&#x8981;&#x8BE6;&#x7EC6;&#x8BB2;&#x8FF0;MAC&#x5C42;&#xFF0C;&#x7269;&#x7406;&#x5C42;&#x63A5;&#x53E3;&#x4EE5;&#x53CA;1588&#x534F;&#x8BAE;&#x652F;&#x6301;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: 网易博客存档">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="fsl_imx6_ethernet_02.html" class="navigation navigation-next " aria-label="Next page: Freescale i.MX6 Linux Ethernet Driver驱动源码分析02">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Freescale i.MX6 Linux Ethernet Driver驱动源码分析01","level":"1.3.1","depth":2,"next":{"title":"Freescale i.MX6 Linux Ethernet Driver驱动源码分析02","level":"1.3.2","depth":2,"path":"Archive/fsl_imx6_ethernet_02.md","ref":"Archive/fsl_imx6_ethernet_02.md","articles":[]},"previous":{"title":"网易博客存档","level":"1.3","depth":1,"path":"Archive/README.md","ref":"Archive/README.md","articles":[{"title":"Freescale i.MX6 Linux Ethernet Driver驱动源码分析01","level":"1.3.1","depth":2,"path":"Archive/fsl_imx6_ethernet_01.md","ref":"Archive/fsl_imx6_ethernet_01.md","articles":[]},{"title":"Freescale i.MX6 Linux Ethernet Driver驱动源码分析02","level":"1.3.2","depth":2,"path":"Archive/fsl_imx6_ethernet_02.md","ref":"Archive/fsl_imx6_ethernet_02.md","articles":[]},{"title":"Linux Programming 经典书单","level":"1.3.3","depth":2,"path":"Archive/linux_books.md","ref":"Archive/linux_books.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Archive/fsl_imx6_ethernet_01.md","mtime":"2021-08-28T08:05:25.858Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-05-16T08:43:12.999Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

